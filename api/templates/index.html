{% extends "base.html" %}

{% block content %}
<div class="mb-8 flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4">
    <div>
        <h2 class="text-2xl font-bold tracking-tight text-foreground">Dashboard</h2>
        <p class="text-muted-foreground text-sm mt-1">Pantau klasifikasi jamur & telemetri secara real-time.</p>
    </div>
    <div class="flex gap-3">
        <button onclick="controlMotor('start')"
            class="inline-flex items-center justify-center rounded-lg text-sm font-semibold transition-all bg-primary text-primary-foreground shadow-md hover:opacity-90 hover:shadow-lg h-10 px-5 py-2 gap-2 active:scale-95">
            <i class="fa-solid fa-play text-xs"></i> Jalankan
        </button>
        <button onclick="controlMotor('stop')"
            class="inline-flex items-center justify-center rounded-lg text-sm font-semibold transition-all border border-input bg-card text-foreground shadow-sm hover:bg-destructive hover:text-destructive-foreground hover:border-destructive h-10 px-5 py-2 gap-2 group active:scale-95">
            <i class="fa-solid fa-stop text-xs text-destructive group-hover:text-white transition-colors"></i> Stop
        </button>
    </div>
</div>

<div class="grid grid-cols-1 lg:grid-cols-12 gap-6">
    <div class="lg:col-span-8 space-y-6">
        <div
            class="rounded-xl border border-border bg-card text-card-foreground shadow-sm overflow-hidden relative group">
            <div class="p-1.5 bg-secondary/30">
                <div
                    class="relative aspect-video bg-gray-100 rounded-lg overflow-hidden flex items-center justify-center border border-black/5 shadow-inner">
                    <div
                        class="absolute top-3 left-3 z-20 flex items-center gap-2 bg-white/90 backdrop-blur-md px-2.5 py-1 rounded-full border border-black/5 shadow-sm">
                        <span class="animate-pulse-slow h-1.5 w-1.5 rounded-full bg-red-500"></span>
                        <span class="text-[10px] font-bold tracking-wider text-gray-800">LIVE</span>
                    </div>
                    <img src="/video_feed" alt="Camera Stream"
                        class="w-full h-full object-cover z-0 opacity-95 group-hover:opacity-100 transition-opacity">
                </div>
            </div>

            <div class="px-5 py-3 border-t border-border bg-card flex justify-between items-center">
                <div class="flex items-center gap-3">
                    <div class="flex items-center gap-1.5 text-xs text-muted-foreground font-mono">
                        <i class="fa-solid fa-video text-primary"></i>
                        <span>C920 PRO HD CAM</span>
                    </div>
                    <span class="text-border">|</span>
                    <span class="text-xs text-muted-foreground font-mono">1280x720 â€¢ MJPG</span>
                </div>
                <div id="motor-status" class="text-xs font-medium text-muted-foreground/80 flex items-center gap-2">
                    <span class="h-1.5 w-1.5 rounded-full bg-muted-foreground"></span> Ready
                </div>
            </div>
        </div>

        <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
            <div
                class="rounded-xl border border-border bg-card text-card-foreground shadow-sm p-6 relative overflow-hidden">
                <div class="absolute top-0 right-0 w-16 h-16 bg-secondary/50 rounded-bl-full -mr-8 -mt-8"></div>
                <div class="flex items-center justify-between mb-6 relative z-10">
                    <h3 class="font-semibold text-sm text-foreground">Nilai</h3>
                    <i class="fa-solid fa-chart-simple text-muted-foreground/50 text-sm"></i>
                </div>
                <div class="relative h-48 w-full">
                    <canvas id="gradeChart"></canvas>
                </div>
            </div>
            <div
                class="rounded-xl border border-border bg-card text-card-foreground shadow-sm p-6 relative overflow-hidden">
                <div class="absolute top-0 right-0 w-16 h-16 bg-secondary/50 rounded-bl-full -mr-8 -mt-8"></div>
                <div class="flex items-center justify-between mb-6 relative z-10">
                    <h3 class="font-semibold text-sm text-foreground">Keakuratan</h3>
                    <i class="fa-solid fa-activity text-muted-foreground/50 text-sm"></i>
                </div>
                <div class="relative h-48 w-full">
                    <canvas id="activityChart"></canvas>
                </div>
            </div>
        </div>
    </div>

    <div class="lg:col-span-4 space-y-6">
        <div
            class="rounded-xl border border-border bg-card text-card-foreground shadow-lg overflow-hidden relative h-fit">
            <div id="glow-bg"
                class="absolute -top-10 -right-10 w-40 h-40 bg-secondary blur-[60px] rounded-full transition-all duration-700">
            </div>

            <div class="p-6 relative z-10">
                <div class="flex items-center justify-between mb-8">
                    <h3 class="font-bold text-sm text-foreground uppercase tracking-wider">Deteksi</h3>
                    <span id="timestamp-badge"
                        class="text-[10px] font-mono text-muted-foreground bg-secondary px-2 py-1 rounded border border-border/50">Menunggu Objek...</span>
                </div>

                <div class="flex flex-col items-center justify-center">
                    <div id="grade-circle"
                        class="w-40 h-40 rounded-full border-[8px] border-secondary bg-background flex items-center justify-center mb-6 transition-all duration-500 shadow-[inset_0_2px_10px_rgba(0,0,0,0.05)]">
                        <span id="grade-display"
                            class="text-7xl font-black text-muted-foreground transition-all duration-300 tracking-tighter opacity-50">-</span>
                    </div>

                    <div class="w-full space-y-2 px-4">
                        <div class="flex justify-between text-xs font-semibold text-muted-foreground">
                            <span>Akurasi</span>
                            <span id="confidence-display">0%</span>
                        </div>
                        <div class="h-2.5 w-full bg-secondary rounded-full overflow-hidden border border-border/30">
                            <div id="confidence-bar"
                                class="h-full bg-primary/50 w-0 transition-all duration-500 ease-out rounded-full shadow-[0_0_10px_currentColor]">
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div class="rounded-xl border border-border bg-card text-card-foreground shadow-sm">
            <div class="p-5">
                <h3 class="font-bold text-sm text-foreground mb-4 flex items-center gap-2">
                    <i class="fa-solid fa-server text-primary/70"></i> Data
                </h3>

                <div class="space-y-3">
                    <div
                        class="flex items-center justify-between p-3.5 rounded-xl bg-primary text-primary-foreground shadow-md transition-transform hover:scale-[1.02]">
                        <div class="flex items-center gap-3">
                            <div
                                class="h-8 w-8 rounded-full bg-white/20 flex items-center justify-center text-white backdrop-blur-sm">
                                <i class="fa-solid fa-cube text-xs"></i>
                            </div>
                            <span class="text-sm font-semibold">Total</span>
                        </div>
                        <span id="stat-total" class="text-xl font-bold font-mono tracking-tight">0</span>
                    </div>

                    <div class="grid grid-cols-3 gap-2.5 mt-2">
                        <div
                            class="bg-secondary/30 p-3 rounded-xl border border-border hover:border-green-300/50 transition-colors text-center group">
                            <div
                                class="text-[10px] font-bold text-muted-foreground mb-1 group-hover:text-green-600 uppercase">
                                Grade A</div>
                            <div id="stat-a" class="text-2xl font-black text-[var(--chart-success)]">0</div>
                        </div>
                        <div
                            class="bg-secondary/30 p-3 rounded-xl border border-border hover:border-yellow-300/50 transition-colors text-center group">
                            <div
                                class="text-[10px] font-bold text-muted-foreground mb-1 group-hover:text-yellow-600 uppercase">
                                Grade B</div>
                            <div id="stat-b" class="text-2xl font-black text-[var(--chart-warning)]">0</div>
                        </div>
                        <div
                            class="bg-secondary/30 p-3 rounded-xl border border-border hover:border-red-300/50 transition-colors text-center group">
                            <div
                                class="text-[10px] font-bold text-muted-foreground mb-1 group-hover:text-red-600 uppercase">
                                Grade C</div>
                            <div id="stat-c" class="text-2xl font-black text-[var(--chart-danger)]">0</div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

    </div>
</div>
{% endblock %}